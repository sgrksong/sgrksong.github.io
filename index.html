function loadVideoByIndex(index) {
  const videos = document.querySelectorAll('#videoList > div');
  if (index < 0 || index >= videos.length) return;
  const title = videos[index].querySelector('a').textContent;
  let nextTitle = '-';

  const isShuffle = document.getElementById('shuffleToggle').checked;
  if (isShuffle) {
    let next;
    do {
      next = Math.floor(Math.random() * videos.length);
    } while (next === index);
    nextTitle = videos[next]?.querySelector('a')?.textContent || '-';
  } else {
    const nextIndex = (index + 1 < videos.length) ? index + 1 : (document.getElementById('repeatToggle').checked ? 0 : -1);
    if (nextIndex !== -1) {
      nextTitle = videos[nextIndex]?.querySelector('a')?.textContent || '-';
    }
  }

  updateNowNextDisplay(videos, title, nextTitle);

  const video = allVideos[index];
  const container = videos[index];
  loadVideo(video, container); // ← これが抜けてた！

  currentIndex = index;
}
